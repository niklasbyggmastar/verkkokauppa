{% include 'shopApp/header.html' %}
{% load filters %}
      <div class="row">
        <span class="ml-3 path mt-2"><a href="{% url 'index' %}"><i class="fas fa-home"></i></a> > <a href="{% url 'results' item.category %}">{{ item.category }}</a> > <a href="{% url 'info' item.id %}">Product {{ item.id }}</a> </span>
        <div class="infoDiv m-3">
          {% for message in messages %}
            <div class="alert {{ message.tags }}" role="alert">
              {{ message }}
            </div>
          {% endfor %}
          <h5 class="p-3 title">{{ item.name }}</h5>
          <!-- Ratig stars -->
          {% if reviews %}
            <div class="font-14 mx-3 mb-3">
              {% for i in loop_times %}
                <i class="fas fa-star"></i>
              {% endfor %}
              {% for i in remaining %}
                <i class="fa fa-star"></i>
              {% endfor %}
              <span class="mx-2">{{ reviews.count }} reviews</span>
              {% if recommended >= 50 %}
                <span class="mx-2" style="color:rgb(19,165,41); font-weight:bold"><i class="fas fa-thumbs-up mx-1"></i>{{ recommended }} % recommend</span>
              {% else %}
                <span class="mx-2" style="color:red; font-weight:bold"><i class="fas fa-thumbs-down mx-1"></i>{{ recommended }} % recommend</span>
              {% endif %}
              <span class="mx-3"><a href="#reviews">Read reviews</a></span>
              <span><a href="{% url 'write' item.id %}">Write a review</a></span>
            </div>
          {% else %}
            <div class="font-14 mx-3 mb-3">
              <i class="fa fa-star"></i>
              <i class="fa fa-star"></i>
              <i class="fa fa-star"></i>
              <i class="fa fa-star"></i>
              <i class="fa fa-star"></i>
              <span class="mx-2">No reviews</span>
              <span><a href="{% url 'write' item.id %}">Write the first review!</a></span>
            </div>
          {% endif %}


          <div class="row p-4" id="rowDiv">
            <div class="col col-md-8 col-xs-12">
              <img class="img img-fluid mx-auto d-block" src="/{{ item.image }}" alt="{{ item.name }}">
            </div>
            <div class="col col-md-4 col-xs-12">
              <div class="p-3 mr-3 mt-5 infoSideBar">
                <li><span><b>Product number:</b> {{ item.id }}</span></li>
                <li><span><b>Manufacturer:</b> {{ item.make }}</span></li>
                <li><span><b>Products available:</b> {{ item.quantityAvailable }}</span></li>
              </div>

              <div class="p-3 mr-3 mt-3 infoSideBar">
                <h6 class="mb-0">Price (alv 24 % /  0 %)</h6>
                <span class="priceTag">{{ item.price }}</span>
                <button onclick="location.href = {% url 'buy' item.id %}" class="btn btn-primary w-100 mt-4"><i class="fas fa-shopping-cart"></i> Add to basket</button>
                <div class="group">
                  <div class="item line"></div>
                  <div class="item text">or</div>
                  <div class="item line"></div>
                </div>
                <button onclick="location.href = {% url 'buy' item.id %}" class="btn btn-secondary w-100 mt-4"><i class="far fa-heart"></i> Add to my list</button>

              <!--  <form action="{% url 'buy' item.id %}" method="post">
                  {% csrf_token %}
                  <input type="submit" value="Add to basket" class="btn btn-primary w-100">
                </form>-->
              </div>
            </div>
          </div>

          <hr>
          <div class="m-4">

              <p>{{ item.desc }}</p>
              {% if item.properties %}
              <h6 style="font-weight:bold">Properties:</h6>
                {% for property in item.properties %}
                  <li class="list-disc ml-4 font-14">{{ property }}</li>
                {% endfor %}
              {% endif %}
              {% if reviews %}
                <section id="reviews">
                  <div class="w-100 p-3 mt-5" style="border:.5px solid grey;">
                    <span class="reviewCount">{{ reviews.count }}</span> <span class="font-16">Reviews</span>
                  </div>
                  <div class="w-100 p-3" style="border-right:.5px solid grey;border-left:.5px solid grey;border-bottom:.5px solid grey;">
                    <div class="row">
                      <div class="col-md-6 text-center">
                        <div class="font-26 mx-3">
                          {% for i in loop_times %}
                            <i class="fas fa-star"></i>
                          {% endfor %}
                          {% for i in remaining %}
                            <i class="fa fa-star"></i>
                          {% endfor %}
                          <span class="mx-3">{{ average_stars }}</span>
                        </div>
                      </div>
                    </div>

                  </div>
                  <div class="w-100 p-3">
                    {% for review in reviews %}
                      {% for i in 0|range:review.stars%}
                        <i class="fas fa-star"></i>
                      {% endfor %}
                      {% for i in review.stars|range:5 %}
                        <i class="fa fa-star"></i>
                      {% endfor %}
                      {% if review.user is None %}
                        <p style="color:gray;"><i class="far fa-user align-center mr-2"></i><span class="mr-4" style="font-weight:bold">{{ review.title }}</span> {{ review.gender }} {{ review.age }} <span class="float-right">{{ review.date_added.date }}</span> </p>
                      {% else %}
                        <p style="color:gray;"><i class="far fa-user align-center mr-2"></i><span class="mr-4" style="font-weight:bold">{{ review.title }}</span> {{ user.first_name }} {{ user.last_name }} <span class="float-right">{{ review.date_added.date }}</span> </p>
                      {% endif %}

                      <p>{{ review.text }}</p>
                      <hr>
                    {% endfor %}
                  </div>

                </section>
              {% endif %}
          </div>

        </div>
      </div>


    </div><!--container-->
  </body>
  <script>
    $(function(){
      checkWidthInfo();
      $(window).on('resize', function(){
        checkWidthInfo();
      });
      $(".alert.alert-success").fadeTo(3000, 500).slideUp(500, function(){
        $(".alert.alert-success").slideUp(500);
      });
    });

    function checkWidthInfo(){
      if($(window).width() < 1000){
        $("#rowDiv").removeClass("row p-4");
      }else{
        $("#rowDiv").addClass("row p-4");
      }
    }

  </script>
</html>
